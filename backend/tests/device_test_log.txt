[2025-11-12 09:45:08] [INFO] 
============================================================
[2025-11-12 09:45:08] [INFO] üöÄ Running All Device API Tests
[2025-11-12 09:45:08] [INFO] ============================================================
[2025-11-12 09:45:08] [INFO] 
üîç Testing: Get Student Embedding
[2025-11-12 09:45:08] [INFO] Endpoint: GET http://localhost:8001/api/students/9afb783f-7952-476d-8626-0143fdbbc2a1/embedding
[2025-11-12 09:45:09] [DEBUG] 
============================================================
[2025-11-12 09:45:09] [DEBUG] Endpoint: GET /api/students/9afb783f-7952-476d-8626-0143fdbbc2a1/embedding
[2025-11-12 09:45:09] [DEBUG] Status Code: 200
[2025-11-12 09:45:09] [DEBUG] Response Headers: {'date': 'Wed, 12 Nov 2025 09:45:08 GMT', 'server': 'uvicorn', 'content-length': '112', 'content-type': 'application/json'}
[2025-11-12 09:45:09] [DEBUG] Response Body: {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'name': 'Emma Johnson', 'embedding': '', 'has_embedding': False}
[2025-11-12 09:45:09] [DEBUG] ============================================================

[2025-11-12 09:45:09] [INFO] ‚úÖ SUCCESS
[2025-11-12 09:45:09] [INFO]    Student: Emma Johnson
[2025-11-12 09:45:09] [INFO]    Has Embedding: False
[2025-11-12 09:45:09] [INFO] 
üì∑ Testing: Get Student Photo
[2025-11-12 09:45:09] [INFO] Endpoint: GET http://localhost:8001/api/students/9afb783f-7952-476d-8626-0143fdbbc2a1/photo
[2025-11-12 09:45:09] [DEBUG] 
============================================================
[2025-11-12 09:45:09] [DEBUG] Endpoint: GET /api/students/9afb783f-7952-476d-8626-0143fdbbc2a1/photo
[2025-11-12 09:45:09] [DEBUG] Status Code: 200
[2025-11-12 09:45:09] [DEBUG] Response Headers: {'date': 'Wed, 12 Nov 2025 09:45:08 GMT', 'server': 'uvicorn', 'content-length': '110', 'content-type': 'application/json'}
[2025-11-12 09:45:09] [DEBUG] Response Body: {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'name': 'Emma Johnson', 'photo_url': None, 'has_photo': False}
[2025-11-12 09:45:09] [DEBUG] ============================================================

[2025-11-12 09:45:09] [INFO] ‚úÖ SUCCESS
[2025-11-12 09:45:09] [INFO]    Student: Emma Johnson
[2025-11-12 09:45:09] [INFO]    Has Photo: False
[2025-11-12 09:45:09] [INFO] 
üé´ Testing: Scan Event - On Board (Yellow)
[2025-11-12 09:45:09] [INFO] Endpoint: POST http://localhost:8001/api/scan_event
[2025-11-12 09:45:09] [INFO]    ‚ÑπÔ∏è  No photo file found at test_scan_photo.jpg, sending without photo
[2025-11-12 09:45:10] [DEBUG] 
============================================================
[2025-11-12 09:45:10] [DEBUG] Endpoint: POST /api/scan_event
[2025-11-12 09:45:10] [DEBUG] Status Code: 422
[2025-11-12 09:45:10] [DEBUG] Response Headers: {'date': 'Wed, 12 Nov 2025 09:45:08 GMT', 'server': 'uvicorn', 'content-length': '658', 'content-type': 'application/json'}
[2025-11-12 09:45:10] [DEBUG] Response Body: {'detail': [{'type': 'missing', 'loc': ['body', 'tag_id'], 'msg': 'Field required', 'input': {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'bus_id': '3ca09d6a-2650-40e7-a874-5b2879025aff', 'rfid_tag': 'RFID-TEST-001', 'verified': True, 'scan_type': 'yellow', 'lat': 37.7749, 'lon': -122.4194}, 'url': 'https://errors.pydantic.dev/2.12/v/missing'}, {'type': 'missing', 'loc': ['body', 'confidence'], 'msg': 'Field required', 'input': {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'bus_id': '3ca09d6a-2650-40e7-a874-5b2879025aff', 'rfid_tag': 'RFID-TEST-001', 'verified': True, 'scan_type': 'yellow', 'lat': 37.7749, 'lon': -122.4194}, 'url': 'https://errors.pydantic.dev/2.12/v/missing'}]}
[2025-11-12 09:45:10] [DEBUG] ============================================================

[2025-11-12 09:45:10] [INFO] ‚ùå FAILED - Status: 422
[2025-11-12 09:45:10] [INFO]    Error: {"detail":[{"type":"missing","loc":["body","tag_id"],"msg":"Field required","input":{"student_id":"9afb783f-7952-476d-8626-0143fdbbc2a1","bus_id":"3ca09d6a-2650-40e7-a874-5b2879025aff","rfid_tag":"RFID-TEST-001","verified":true,"scan_type":"yellow","lat":37.7749,"lon":-122.4194},"url":"https://errors.pydantic.dev/2.12/v/missing"},{"type":"missing","loc":["body","confidence"],"msg":"Field required","input":{"student_id":"9afb783f-7952-476d-8626-0143fdbbc2a1","bus_id":"3ca09d6a-2650-40e7-a874-5b2879025aff","rfid_tag":"RFID-TEST-001","verified":true,"scan_type":"yellow","lat":37.7749,"lon":-122.4194},"url":"https://errors.pydantic.dev/2.12/v/missing"}]}
[2025-11-12 09:45:10] [INFO] 
üé´ Testing: Scan Event - Reached (Green)
[2025-11-12 09:45:10] [INFO] Endpoint: POST http://localhost:8001/api/scan_event
[2025-11-12 09:45:10] [INFO]    ‚ÑπÔ∏è  No photo file found at test_scan_photo.jpg, sending without photo
[2025-11-12 09:45:10] [DEBUG] 
============================================================
[2025-11-12 09:45:10] [DEBUG] Endpoint: POST /api/scan_event
[2025-11-12 09:45:10] [DEBUG] Status Code: 422
[2025-11-12 09:45:10] [DEBUG] Response Headers: {'date': 'Wed, 12 Nov 2025 09:45:08 GMT', 'server': 'uvicorn', 'content-length': '656', 'content-type': 'application/json'}
[2025-11-12 09:45:10] [DEBUG] Response Body: {'detail': [{'type': 'missing', 'loc': ['body', 'tag_id'], 'msg': 'Field required', 'input': {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'bus_id': '3ca09d6a-2650-40e7-a874-5b2879025aff', 'rfid_tag': 'RFID-TEST-001', 'verified': True, 'scan_type': 'green', 'lat': 37.7749, 'lon': -122.4194}, 'url': 'https://errors.pydantic.dev/2.12/v/missing'}, {'type': 'missing', 'loc': ['body', 'confidence'], 'msg': 'Field required', 'input': {'student_id': '9afb783f-7952-476d-8626-0143fdbbc2a1', 'bus_id': '3ca09d6a-2650-40e7-a874-5b2879025aff', 'rfid_tag': 'RFID-TEST-001', 'verified': True, 'scan_type': 'green', 'lat': 37.7749, 'lon': -122.4194}, 'url': 'https://errors.pydantic.dev/2.12/v/missing'}]}
[2025-11-12 09:45:10] [DEBUG] ============================================================

[2025-11-12 09:45:10] [INFO] ‚ùå FAILED - Status: 422
[2025-11-12 09:45:10] [INFO]    Error: {"detail":[{"type":"missing","loc":["body","tag_id"],"msg":"Field required","input":{"student_id":"9afb783f-7952-476d-8626-0143fdbbc2a1","bus_id":"3ca09d6a-2650-40e7-a874-5b2879025aff","rfid_tag":"RFID-TEST-001","verified":true,"scan_type":"green","lat":37.7749,"lon":-122.4194},"url":"https://errors.pydantic.dev/2.12/v/missing"},{"type":"missing","loc":["body","confidence"],"msg":"Field required","input":{"student_id":"9afb783f-7952-476d-8626-0143fdbbc2a1","bus_id":"3ca09d6a-2650-40e7-a874-5b2879025aff","rfid_tag":"RFID-TEST-001","verified":true,"scan_type":"green","lat":37.7749,"lon":-122.4194},"url":"https://errors.pydantic.dev/2.12/v/missing"}]}
[2025-11-12 09:45:10] [INFO] 
üìç Testing: Update Bus Location
[2025-11-12 09:45:10] [INFO] Endpoint: POST http://localhost:8001/api/update_location
[2025-11-12 09:45:11] [DEBUG] 
============================================================
[2025-11-12 09:45:11] [DEBUG] Endpoint: POST /api/update_location
[2025-11-12 09:45:11] [DEBUG] Status Code: 200
[2025-11-12 09:45:11] [DEBUG] Response Headers: {'date': 'Wed, 12 Nov 2025 09:45:08 GMT', 'server': 'uvicorn', 'content-length': '67', 'content-type': 'application/json'}
[2025-11-12 09:45:11] [DEBUG] Response Body: {'status': 'success', 'timestamp': '2025-11-12T09:45:11.325446+00:00'}
[2025-11-12 09:45:11] [DEBUG] ============================================================

[2025-11-12 09:45:11] [INFO] ‚úÖ SUCCESS
[2025-11-12 09:45:11] [INFO]    Status: success
[2025-11-12 09:45:11] [INFO]    Bus ID: 3ca09d6a-2650-40e7-a874-5b2879025aff
[2025-11-12 09:45:11] [INFO]    GPS: (37.7749, -122.4194)
[2025-11-12 09:45:11] [INFO] 
============================================================
[2025-11-12 09:45:11] [INFO] üìä Test Summary
[2025-11-12 09:45:11] [INFO] ============================================================
[2025-11-12 09:45:11] [INFO]    get_embedding: ‚úÖ PASSED
[2025-11-12 09:45:11] [INFO]    get_photo: ‚úÖ PASSED
[2025-11-12 09:45:11] [INFO]    scan_yellow: ‚ùå FAILED
[2025-11-12 09:45:11] [INFO]    scan_green: ‚ùå FAILED
[2025-11-12 09:45:11] [INFO]    update_location: ‚úÖ PASSED
[2025-11-12 09:45:11] [INFO] 
Results: 3/5 tests passed (60%)
